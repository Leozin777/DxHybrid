import{_ as t}from"./_tslib-6e8ca86b.js";import{r as e,a as o,D as i}from"./dropdowncomponents-441350a4.js";import{D as n}from"./popupportal-d99ac31f.js";import{C as r}from"./custom-events-helper-18f7786a.js";import{P as s}from"./point-37917280.js";import{D as a,P as l,a as c,H as p,T as h}from"./dx-html-element-pointer-events-helper-10ee3756.js";import{P as d,C as u,d as m,e as w,a as g,b as f,f as y,Z as b}from"./popup-1940fd5f.js";import{e as x}from"./custom-element-267f9a21.js";import{s as v,y as C}from"./lit-element-70cf14f4.js";import{e as P}from"./property-d3853089.js";import"./thumb-0cefcb05.js";import"./data-qa-utils-8be7c726.js";import"./eventhelper-8570b930.js";import"./rect-6159d026.js";import"./layouthelper-910ca836.js";import"./events-interseptor-8aee1ab4.js";import"./branch-bf06b0d2.js";import"./logicaltreehelper-ec583f1d.js";import"./dom-25ebd160.js";import"./rafaction-bba7928b.js";import"./transformhelper-ebad0156.js";import"./positiontracker-eebf89fe.js";import"./capturemanager-63058346.js";import"./dx-ui-element-39d22b67.js";import"./lit-element-base-c6695e09.js";import"./nameof-factory-64d95f5b.js";var A,D,E,j;!function(t){t.Center="Center",t.Left="Left",t.Right="Right"}(E||(E={})),function(t){t.Top="Top",t.Center="Center",t.Bottom="Bottom"}(j||(j={}));let T=class extends n{};T=t([x("dxbl-window-dialog")],T);let S=class extends o{constructor(){super()}};S=t([x("dxbl-window-root")],S);class z{constructor(t,e){this.x=e.x,this.y=e.y}}class R extends CustomEvent{constructor(t,e){super(R.eventName,{detail:new z(t,e),bubbles:!0,composed:!0,cancelable:!1})}}R.eventName="dxbl-window.dragCompleted",r.register(R.eventName,(t=>t.detail));class X{constructor(t){this.x=t.x,this.y=t.y}}class Y extends CustomEvent{constructor(t){super(Y.eventName,{detail:new X(t),bubbles:!0,composed:!0,cancelable:!1})}}Y.eventName="dxbl-window.dragStarted",r.register(Y.eventName,(t=>t.detail));let M=A=class extends v{constructor(){super(),this.allowDrag=!1,this.pointerEventsHelper=new a(this)}connectedCallback(){super.connectedCallback();const t=this.closest("dxbl-window");if(!t)throw new Error("DxWindowHeader should be placed within a DxWindow");this.pointerEventsHelper.initialize(),this.allowDrag&&this.addEventListener(l.eventName,(e=>{const o=e,i=A.calculatePositionDelta(this,o.detail.source),n=A.createPoint(i,o.detail.source);let r=n;const s=()=>{t.positionX=r.x,t.positionY=r.y,a=requestAnimationFrame(s)};let a=requestAnimationFrame(s);const l=t=>{r=A.createPoint(i,t)};document.addEventListener("pointermove",l),this.addEventListener(c.eventName,(t=>{this.style.cursor="",this.style.userSelect="",cancelAnimationFrame(a),document.removeEventListener("pointermove",l);const e=A.createPoint(i,t.detail.source);this.shadowRoot.dispatchEvent(new R(n,e))}),{once:!0}),this.style.cursor="move",this.style.userSelect="none",this.shadowRoot.dispatchEvent(new Y(n))}))}disconnectedCallback(){super.disconnectedCallback(),this.pointerEventsHelper.dispose()}get handlePointerEventsMode(){return p.Dragging}get handlePointerEventsTarget(){return this}get handlePointerEventsDelay(){return h}render(){return C`<slot></slot>`}static calculatePositionDelta(t,e){const o=t.getBoundingClientRect();return new s(Math.floor(e.clientX)-o.x,Math.floor(e.clientY)-o.y)}static createPoint(t,e){return new s(Math.floor(e.clientX+window.scrollX)-t.x,Math.floor(e.clientY+window.scrollY)-t.y)}};t([P({type:Boolean,attribute:"allow-drag",reflect:!1})],M.prototype,"allowDrag",void 0),M=A=t([x("dxbl-window-header")],M);let N=D=class extends i{constructor(){super(),this.sizeDirty=!1,this.positionYDirty=!1,this.positionXDirty=!1,this.showAnchorElement=null,this._showOptionsToApply=null,this.horizontalAlignment=E.Center,this.verticalAlignment=j.Center,this.closeOnEscape=!1,this.zIndex=0,this.placement=d.Custom,this.closeMode=u.None}get positionY(){return this.offset.y}set positionY(t){this.positionYDirty=!0,this.offset=new s(this.positionX||0,t||0)}get positionX(){return this.offset.x}set positionX(t){this.positionXDirty=!0,this.offset=new s(t||0,this.positionY||0)}get showOptionsToApply(){return this._showOptionsToApply}set showOptionsToApply(t){this._showOptionsToApply=t,this.positionXDirty=!1,this.positionYDirty=!1}move(t){return this.showOptionsToApply=t,this.forceReposition(),new Promise(((t,e)=>{requestAnimationFrame((()=>{setTimeout((()=>{t()}))}))}))}showAt(t){return this.showOptionsToApply=t,super.show(),new Promise(((t,e)=>{requestAnimationFrame((()=>{setTimeout((()=>{t()}))}))}))}show(){this.showAt(this.showOptionsToApply).catch((t=>{}))}static getPlacementTarget(t){if(null!==t){if(null!==t.targetReference&&t.targetReference instanceof HTMLElement)return t.targetReference;if(null!==t.targetSelector){const e=document.querySelector(t.targetSelector);if(null!==e)return e}}return document.body}static getShowAtBox(t){return null===t?null:null!==t.targetReference&&t.targetReference instanceof HTMLElement?D.getElementTopLeftPoint(t.targetReference):null!==t.targetSelector?D.getElementTopLeftPoint(document.querySelector(t.targetSelector)):t.targetPoint}static getElementTopLeftPoint(t){if(null===t)return null;const e=t.getBoundingClientRect();return new s(e.left,e.top)}canProcessEscapeKeyDown(){return this.closeOnEscape}renderTemplate(){return C`
            <dxbl-branch
                id="branch"
                branch-id="${this.branchId}"
                parent-branch-id="${this.parentBranchId}"
                type="${this.branchType}"
                style="${this.dragCssStyle}">
                <dxbl-window-root
                    id="root"
                    style="${this.rootCssStyle}"
                    ?resizing="${this.resizing}"
                    drop-opposite="${this.actualDropOpposite}"
                    drop-direction="${this.actualDropDirection}"
                    drop-alignment="${this.actualDropAlignment}">
                    ${this.renderDefaultSlot()}
                    ${this.renderAdditionalSlots()}
                    ${this.renderBridgeSlot()}
                </dxbl-window-root>
            </dxbl-branch>
        `}raiseResizeCompleted(t,e){this.sizeDirty=!0,super.raiseResizeCompleted(t,e)}processCustomPlacement(t,e){if(this.positionXDirty||this.positionYDirty||this.isInDragOperation||this.sizeDirty)return null;const o=this.showOptionsToApply;if(o){const t=o.targetPoint||this.calcShowPoint(o);return[new m(t,w.None,!1,g.Near,f.bottom)]}return null}calcShowPoint(t){const e=D.getPlacementTarget(t),o=this.getBoundingClientRect(),i=e.getBoundingClientRect(),n=document.body.getBoundingClientRect(),r=this.calcShowXPoint(o,i),a=this.calcShowYPoint(o,i),l=n.y+n.height-o.height;return new s(Math.max(0,r+window.scrollX-Math.max(0,r-(n.x+n.width-o.width))),Math.max(0,a+window.scrollY-Math.max(0,a-l)))}calcShowXPoint(t,e){return Math.floor((()=>{switch(this.horizontalAlignment){case E.Left:return e.x;case E.Right:return e.x+e.width-t.width;case E.Center:return e.x+e.width/2-t.width/2}throw new Error("calcShowXPoint not supported for horizontalAlignment:"+this.horizontalAlignment)})())}calcShowYPoint(t,e){return Math.floor((()=>{switch(this.verticalAlignment){case j.Top:return e.y;case j.Bottom:return e.y+e.height-t.height;case j.Center:return e.y+e.height/2-t.height/2}throw new Error("calcShowYPoint not supported for horizontalAlignment:"+this.verticalAlignment)})())}updated(t){super.update(t),t.has("zIndex")&&this.zIndex&&this.raiseZIndexChange()}raiseZIndexChange(){this.updateComplete.then((t=>{this.dispatchEvent(new y(new b(this.zIndex)))}))}};function O(t){if(!t)throw new Error("failed");return t}t([P({type:E,attribute:"horizontal-alignment",reflect:!1})],N.prototype,"horizontalAlignment",void 0),t([P({type:E,attribute:"vertical-alignment",reflect:!1})],N.prototype,"verticalAlignment",void 0),t([P({type:Number,attribute:"position-y",reflect:!1})],N.prototype,"positionY",null),t([P({type:Number,attribute:"position-x",reflect:!1})],N.prototype,"positionX",null),t([P({type:Boolean,attribute:"close-on-escape"})],N.prototype,"closeOnEscape",void 0),t([P({type:Number,attribute:"z-index"})],N.prototype,"zIndex",void 0),N=D=t([x("dxbl-window")],N);export{N as DxWindow,R as WindowDragCompletedEvent,Y as WindowDragStartedEvent,O as getWindowRef};
